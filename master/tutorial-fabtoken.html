<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>Hyperledger Fabric SDK for node.js Tutorial: fabric-client: How to perform token operations</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	<link type="text/css" rel="stylesheet" href="styles/site.cosmo.css">

</head>

<body>

<div class="navbar navbar-default navbar-fixed-top ">
<div class="container">
	<div class="navbar-header">
		<a class="navbar-brand" href="index.html">Hyperledger Fabric SDK for node.js</a>
		<button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#topNavigation">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
        </button>
	</div>
	<div class="navbar-collapse collapse" id="topNavigation">
		<ul class="nav navbar-nav">
			
			<li class="dropdown">
				<a href="modules.list.html" class="dropdown-toggle" data-toggle="dropdown">Modules<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="module-fabric-network.html">fabric-network</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="AffiliationService.html">AffiliationService</a></li><li><a href="BasePackager.html">BasePackager</a></li><li><a href="BaseWallet.html">BaseWallet</a></li><li><a href="BasicCommitHandler.html">BasicCommitHandler</a></li><li><a href="BasicProverHandler.html">BasicProverHandler</a></li><li><a href="BlockDecoder.html">BlockDecoder</a></li><li><a href="CertificateAuthority.html">CertificateAuthority</a></li><li><a href="Chaincode.html">Chaincode</a></li><li><a href="ChaincodeRegistration.html">ChaincodeRegistration</a></li><li><a href="Channel.html">Channel</a></li><li><a href="ChannelEventHub.html">ChannelEventHub</a></li><li><a href="ChannelPeer.html">ChannelPeer</a></li><li><a href="Client.html">Client</a></li><li><a href="CommitHandler.html">CommitHandler</a></li><li><a href="DiscoveryEndorsementHandler.html">DiscoveryEndorsementHandler</a></li><li><a href="EndorsementHandler.html">EndorsementHandler</a></li><li><a href="EndorsementPolicy.html">EndorsementPolicy</a></li><li><a href="Endpoint.html">Endpoint</a></li><li><a href="event_hub_number.html">event_hub_number</a></li><li><a href="FabricCAClient.html">FabricCAClient</a></li><li><a href="FabricCAServices.html">FabricCAServices</a></li><li><a href="IdentityService.html">IdentityService</a></li><li><a href="InMemoryKVS.html">InMemoryKVS</a></li><li><a href="module-fabric-network.AbstractEventHubSelectionStrategy.html">fabric-network.AbstractEventHubSelectionStrategy</a></li><li><a href="module-fabric-network.AbstractEventListener.html">fabric-network.AbstractEventListener</a></li><li><a href="module-fabric-network.BaseCheckpointer.html">fabric-network.BaseCheckpointer</a></li><li><a href="module-fabric-network.CommitEventListener.html">fabric-network.CommitEventListener</a></li><li><a href="module-fabric-network.Contract.html">fabric-network.Contract</a></li><li><a href="module-fabric-network.ContractEventListener.html">fabric-network.ContractEventListener</a></li><li><a href="module-fabric-network.CouchDBWallet.html">fabric-network.CouchDBWallet</a></li><li><a href="module-fabric-network.EventHubDisconnectError.html">fabric-network.EventHubDisconnectError</a></li><li><a href="module-fabric-network.FabricError.html">fabric-network.FabricError</a></li><li><a href="module-fabric-network.FileSystemCheckpointer.html">fabric-network.FileSystemCheckpointer</a></li><li><a href="module-fabric-network.FileSystemWallet.html">fabric-network.FileSystemWallet</a></li><li><a href="module-fabric-network.Gateway.html">fabric-network.Gateway</a></li><li><a href="module-fabric-network.HSMWalletMixin.html">fabric-network.HSMWalletMixin</a></li><li><a href="module-fabric-network.InMemoryWallet.html">fabric-network.InMemoryWallet</a></li><li><a href="module-fabric-network.Network.html">fabric-network.Network</a></li><li><a href="module-fabric-network.Query.html">fabric-network.Query</a></li><li><a href="module-fabric-network.RoundRobinEventHubSelectionStrategy.html">fabric-network.RoundRobinEventHubSelectionStrategy</a></li><li><a href="module-fabric-network.TimeoutError.html">fabric-network.TimeoutError</a></li><li><a href="module-fabric-network.Transaction.html">fabric-network.Transaction</a></li><li><a href="module-fabric-network.X509WalletMixin.html">fabric-network.X509WalletMixin</a></li><li><a href="MSP.html">MSP</a></li><li><a href="MSPManager.html">MSPManager</a></li><li><a href="NetworkConfig_1_0.html">NetworkConfig_1_0</a></li><li><a href="Orderer.html">Orderer</a></li><li><a href="Organization.html">Organization</a></li><li><a href="Peer.html">Peer</a></li><li><a href="ProverHandler.html">ProverHandler</a></li><li><a href="Remote.html">Remote</a></li><li><a href="TokenClient.html">TokenClient</a></li><li><a href="TransactionID.html">TransactionID</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="interfaces.list.html" class="dropdown-toggle" data-toggle="dropdown">Interfaces<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="module-fabric-network.Wallet.html">fabric-network.Wallet</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="tutorials.list.html" class="dropdown-toggle" data-toggle="dropdown">Tutorials<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="tutorial-app-dev-env-setup.html">Setting up the Application Developer's Environment</a></li><li><a href="tutorial-chaincode-lifecycle.html">fabric-client: How to install and start your chaincode</a></li><li><a href="tutorial-channel-create.html">fabric-client: How to create a Hyperledger Fabric channel</a></li><li><a href="tutorial-channel-events.html">fabric-client: How to use the channel-based event service</a></li><li><a href="tutorial-discovery.html">fabric-client: How to use the discovery service</a></li><li><a href="tutorial-event-checkpointer.html">fabric-network: How to replay missed events</a></li><li><a href="tutorial-event-hub-management.html">fabric-network: How to automatically select and reconnect to event hubs</a></li><li><a href="tutorial-fabtoken.html">fabric-client: How to perform token operations</a></li><li><a href="tutorial-grpc-settings.html">fabric-client: How to set gRPC settings</a></li><li><a href="tutorial-handlers.html">fabric-client: How to use the endorsement and commit handlers</a></li><li><a href="tutorial-listening-to-events.html">fabric-network: How to listen to events</a></li><li><a href="tutorial-logging.html">fabric-client: How to use logging</a></li><li><a href="tutorial-metadata-chaincode.html">fabric-client: How to add CouchDB indexes during chaincode installation</a></li><li><a href="tutorial-mutual-tls.html">fabric-client: How to configure mutual TLS</a></li><li><a href="tutorial-network-config.html">fabric-client: How to use a common connection profile</a></li><li><a href="tutorial-private-data.html">How to use private data</a></li><li><a href="tutorial-query-peers.html">fabric-network: How to select peers for evaluating transactions (queries)</a></li><li><a href="tutorial-sign-transaction-offline.html">Working with an offline private key</a></li><li><a href="tutorial-transaction-commit-events.html">fabric-network: How to wait for transactions to be committed to the ledger</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="global.html" class="dropdown-toggle" data-toggle="dropdown">Global<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="global.html#CLIENT">CLIENT</a></li><li><a href="global.html#finalPackage">finalPackage</a></li><li><a href="global.html#HFAFFILIATIONMGR">HFAFFILIATIONMGR</a></li><li><a href="global.html#HFGENCRL">HFGENCRL</a></li><li><a href="global.html#HFINTERMEDIATECA">HFINTERMEDIATECA</a></li><li><a href="global.html#HFREGISTRARATTRIBUTES">HFREGISTRARATTRIBUTES</a></li><li><a href="global.html#HFREGISTRARDELEGATEROLES">HFREGISTRARDELEGATEROLES</a></li><li><a href="global.html#HFREGISTRARROLES">HFREGISTRARROLES</a></li><li><a href="global.html#HFREVOKER">HFREVOKER</a></li><li><a href="global.html#loadConfigGroup">loadConfigGroup</a></li><li><a href="global.html#loadConfigValue">loadConfigValue</a></li><li><a href="global.html#ORDERER">ORDERER</a></li><li><a href="global.html#package">package</a></li><li><a href="global.html#PEER">PEER</a></li><li><a href="global.html#toEnvelope">toEnvelope</a></li><li><a href="global.html#toHex">toHex</a></li><li><a href="global.html#toSignedCommand">toSignedCommand</a></li><li><a href="global.html#USER">USER</a></li>
				</ul>
			</li>
			
		</ul>
        
            <div class="col-sm-3 col-md-3">
                <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search" name="q" id="search-input">
                        <div class="input-group-btn">
                            <button class="btn btn-default" id="search-submit"><i class="glyphicon glyphicon-search"></i></button>
                        </div>
                    </div>
                </form>
            </div>
        
	</div>

</div>
</div>


<div class="container" id="toc-content">
<div class="row">

	
	<div class="col-md-12">
	
		<div id="main">
			<section class="tutorial-section">

<header>
    

    <h2>fabric-client: How to perform token operations</h2>
</header>

<article>
    <p>This tutorial illustrates how to perform FabToken operations using
the Node.js fabric-client SDK. FabToken is a new feature in
Hyperledger Fabric 2.0 Alpha and fabric-client 2.0 Alpha.</p>
<p>For more information about tokens on Hyperledger Fabric, see
<a href="https://hyperledger-fabric.readthedocs.io/en/latest/token/FabToken.html">Using Fabtoken</a></p>
<p>For more information on:</p>
<ul>
<li>getting started with Hyperledger Fabric see
<a href="http://hyperledger-fabric.readthedocs.io/en/latest/build_network.html">Building your first network</a>.</li>
<li>the configuration of a channel in Hyperledger Fabric and the internal
process of creating and updating see
<a href="http://hyperledger-fabric.readthedocs.io/en/latest/configtx.html">Hyperledger Fabric channel configuration</a></li>
</ul>
<p>The following assumes an understanding of the Hyperledger Fabric network
(orderers, peers, and channels), and of Node.js application development,
including the use of the Javascript <code>promise</code> and <code>async await</code>.</p>
<h3>Overview</h3>
<p>This tutorial will focus on the APIs for an application program to perform
the token operations. These operations will be transactions on the hyperledger fabric
channel ledger and the application may monitor for their completion using the channel
event service see <a href="tutorial-channel-events.html">How to use the channel-based event service</a></p>
<h4>New Class</h4>
<p>A new class <a href="TokenClient.html">TokenClient</a> has been added to the fabric-client to support token operations.
A <a href="TokenClient.html">TokenClient</a> instance will be created by a client instance's
<a href="Client.html#newTokenClient">newTokenClient()</a> method.
Then using the new instance, you will be able to invoke the following methods.</p>
<ul>
<li><a href="TokenClient.html#issue">issue</a> - Issue new tokens to the specified users.</li>
<li><a href="TokenClient.html#transfer">transfer</a> - Transfer owning tokens to other users.</li>
<li><a href="TokenClient.html#redeem">redeem</a> - Redeem owning tokens.</li>
<li><a href="TokenClient.html#list">list</a> - Query owning tokens.</li>
</ul>
<h4>New Method on Client</h4>
<p>The <a href="Client.html">Client</a> class has been enhanced to include a new method to create
a <a href="TokenClient.html">TokenClient</a> instance. Like Client, a TokenClient is associated with a user context.</p>
<ul>
<li><a href="Client.html#newTokenClient">newTokenClient()</a> - Create a new <a href="TokenClient.html">TokenClient</a> instance.</li>
</ul>
<h3>Sample code</h3>
<p>The following sample code assumes that all of the normal fabric-client setup
has been completed and only shows the TokenClient calls.
It demonstrates how to issue, transfer, redeem, and list tokens.</p>
<h4>Prerequisites:</h4>
<p>Assume the following objects have been created:</p>
<ul>
<li>issuer, client (associated to issuer context)</li>
<li>user1, client1 (associated to user1 context)</li>
<li>user2, client2 (associated to user1 context)</li>
<li>mychannel</li>
</ul>
<h4>Use case 1: issue tokens</h4>
<p>The issuer issues tokens to user1 and user 2</p>
<pre class="prettyprint source"><code>// create a TokenClient instance from client
const tokenclient = client.newTokenClient(mychannel);

// create a transaction ID for &quot;issuer&quot;
const txId = client.newTransactionID();

// create two parameters for issue, one for user1 and one for user2
const param1 = {
	owner: user1.getIdentity().serialize(),
	type: 'USD',
	quantity: '500',
};
const param2 = {
	owner: user2.getIdentity().serialize(),
	type: 'EURO',
	quantity: '300',
};

// create the token request for issue
const issueRequest = {
	params: [param1, param2],
	txId: txId,
};

// issuer calls issue method to issue tokens to user1 and user2
const result = await tokenClient.issue(issueRequest);

// The above method broadcasts the transaction to the orderer.
// You can monitor its completion with the channel event service
</code></pre>
<h4>Use case 2: list tokens</h4>
<p>You can only list unspent tokens owned by yourself.</p>
<pre class="prettyprint source"><code>// create a TokenClient instance from client1
const user1Tokenclient = client1.newTokenClient(mychannel);

// user1 lists tokens
const mytokens = await user1TokenClient.list();

// iterate the tokens to get token id, type, and quantity for each token
for (const token of tokens) {
	// get token.id, token.type, and token.quantity
	// token.id will be used for transfer and redeem
}
</code></pre>
<h4>Use case 3: transfer tokens</h4>
<p>You can only transfer tokens owned by yourself. Call the &quot;list&quot; method to get the token id(s) you want to transfer.
Assume user1 wants to transfer 'tokenid1' to user2. The token quantity is 500 and
user1 wants to transfer 300 to user2.  The remaining 200 will be transferred to user1
because the total quantity for transfer must be same as the total quanity in the original tokens.</p>
<pre class="prettyprint source"><code>// create a request (see TokenRequest doc) for transfer.
// After transfer, user2 will have 300 quantity of the token and user1 will have 200 quantity of the token.

// create the transaction ID for &quot;user1&quot; who will transfer tokens
const txId = client1.newTransactionID();

// create two parameters, where param1 is to transfer 300 to user2 and param2 is to transfer the remaining 200 to user1.
const param1 = {
	owner: user2.getIdentity().serialize(),
	quantity: '300',
};
const param2 = {
	owner: user1.getIdentity().serialize(),
	quantity: '200',
};

// create the request for transfer
const transferRequest = {
	tokenIds: [tokenid1],
	params: [param1, param2],
	txId: txId,
};

// user1 calls transfer method to transfer the token to user2
// after transfer, the old &quot;tokenid1&quot; will be destroyed and new token ids will be created
const mytokens = await user1TokenClient.transfer(transferRequest);

// The above method broadcasts the transaction to the orderer.
// You can monitor its completion with the channel event service
</code></pre>
<h4>Use case 4: redeem tokens</h4>
<p>You can only redeem tokens owned by yourself. Call the &quot;list&quot; method to get the token id(s) you want to redeem.
Assume user2 wants to redeem 100 out of 300 from the &quot;tokenid2&quot; token.</p>
<pre class="prettyprint source"><code>// create a TokenClient instance from client2
const user2Tokenclient = client2.newTokenClient(mychannel);

// create a request (see TokenRequest doc) for redeem
const txId = client2.newTransactionID();
const param = {
	quantity: '100',
};
const redeemRequest = {
	tokenIds: [tokenid2],
	params: [param],
	txId: txId,
};

// user2 calls redeem method.
const result = await user2TokenClient.redeem(redeemRequest);

// The above method broadcasts the transaction to the orderer.
// You can monitor its completion with the channel event service

// After redeem, user2 will have 200 left, with a new token id.
// The old &quot;tokenid2&quot; will be destroyed since it has been spent.
// You can call list to verify the result.
const tokens = await user2TokenClient.list();
</code></pre>
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
<img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a>
<br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
Creative Commons Attribution 4.0 International License</a>.
</article>

</section>

		</div>
	</div>

	<div class="clearfix"></div>

	

</div>
</div>


    <div class="modal fade" id="searchResults">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">Search results</h4>
          </div>
          <div class="modal-body"></div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div>


<footer>


<span class="jsdoc-message">
	Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.2</a>
	
		on 2019-05-16T16:09:00+00:00
	
	using the <a href="https://github.com/docstrap/docstrap">DocStrap template</a>.
</span>
</footer>

<script src="scripts/docstrap.lib.js"></script>
<script src="scripts/toc.js"></script>

    <script type="text/javascript" src="scripts/fulltext-search-ui.js"></script>


<script>
$( function () {
	$( "[id*='$']" ).each( function () {
		var $this = $( this );

		$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
	} );

	$( ".tutorial-section pre, .readme-section pre, pre.prettyprint.source" ).each( function () {
		var $this = $( this );

		var example = $this.find( "code" );
		exampleText = example.html();
		var lang = /{@lang (.*?)}/.exec( exampleText );
		if ( lang && lang[1] ) {
			exampleText = exampleText.replace( lang[0], "" );
			example.html( exampleText );
			lang = lang[1];
		} else {
			var langClassMatch = example.parent()[0].className.match(/lang\-(\S+)/);
			lang = langClassMatch ? langClassMatch[1] : "javascript";
		}

		if ( lang ) {

			$this
			.addClass( "sunlight-highlight-" + lang )
			.addClass( "linenums" )
			.html( example.html() );

		}
	} );

	Sunlight.highlightAll( {
		lineNumbers : false,
		showMenu : true,
		enableDoclinks : true
	} );

	$.catchAnchorLinks( {
        navbarOffset: 10
	} );
	$( "#toc" ).toc( {
		anchorName  : function ( i, heading, prefix ) {
			return $( heading ).attr( "id" ) || ( prefix + i );
		},
		selectors   : "#toc-content h1,#toc-content h2,#toc-content h3,#toc-content h4",
		showAndHide : false,
		smoothScrolling: true
	} );

	$( "#main span[id^='toc']" ).addClass( "toc-shim" );
	$( '.dropdown-toggle' ).dropdown();

    $( "table" ).each( function () {
      var $this = $( this );
      $this.addClass('table');
    } );

} );
</script>



<!--Navigation and Symbol Display-->


<!--Google Analytics-->



    <script type="text/javascript">
        $(document).ready(function() {
            SearcherDisplay.init();
        });
    </script>


</body>
</html>